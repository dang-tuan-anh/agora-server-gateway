# Use an official OpenJDK runtime as a parent image
FROM mcr.microsoft.com/devcontainers/java:1-21-bullseye

# Set the working directory
WORKDIR /app

# Install necessary dependencies for Agora C++ SDK
RUN apt-get update && \
    apt-get install -y \
    build-essential \
    cmake \
    git \
    wget \
    unzip \
    maven \
    libx11-dev \
    libxfixes-dev \
    libxext-dev \
    libdrm-dev

# Download and install Agora C++ SDK
RUN ldconfig

# Copy the current directory contents into the container at /app
COPY . /app

# Set the environment variable for Java library path
ENV LD_LIBRARY_PATH /usr/local/lib

# Compile the Maven project
# RUN mvn clean package


EXPOSE 5005
# # Run the Java application
# CMD ["java", "-cp", "target/agora-example-1.0-SNAPSHOT.jar:target/lib", "com.example.Main"]
# CMD ["sh", "-c", "while :; do sleep 2073600; done"]
